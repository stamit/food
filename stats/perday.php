<? $AUTH='consumption';
	require_once 'app/init.php';
	require_once 'app/data.php';
	require_once 'lib/maketable/fun.php';

	include 'app/begin.php';
	maketable(array(
		'self'=>$URL.'/stats/perday',
		'key'=>'id',
		'join'=>array(
			array('consumption','groupby'=>'DATE(consumption.consumed)'),
			array('product',array('id'=>'consumption.product'),'group'),
		),
		'columns'=>array(
			'DATE(consumption.consumed)'=>array('Day',
				'search'=>'mid',
			),
			'SUM(consumption.weight*product.energy/product.sample_weight)'=>array(
				'Energy',
				'f'=>'quantity_html',
				'postfix'=>' kcal',
				'class'=>'number',
			),
			'SUM(consumption.weight*product.water/product.sample_weight)'=>array(
				'H₂O',
				'f'=>'quantity_html',
				'postfix'=>'g',
				'class'=>'number',
			),
			'SUM(consumption.weight*product.proteins/product.sample_weight)'=>array(
				'Prot.',
				'f'=>'quantity_html',
				'postfix'=>'g',
				'class'=>'number',
			),
			'SUM(consumption.weight*product.carbohydrates/product.sample_weight)'=>array(
				'Carb.',
				'tip'=>'Υδατάνθρακες',
				'f'=>'quantity_html',
				'postfix'=>'g',
				'class'=>'number',
			),
			'SUM(consumption.weight*product.sugars/product.sample_weight)'=>array(
				'Sug.',
				'tip'=>'Σάκχαρα',
				'f'=>'quantity_html',
				'postfix'=>'g',
				'class'=>'number',
			),
			'SUM(consumption.weight*product.fats/product.sample_weight)'=>array(
				'Fat',
				'f'=>'quantity_html',
				'postfix'=>'g',
				'class'=>'number',
			),
			'SUM(consumption.weight*product.fats_saturated/product.sample_weight)'=>array(
				'S.F.',
				'f'=>'quantity_html',
				'postfix'=>'g',
				'class'=>'number',
			),
			'SUM(consumption.weight*product.total_fiber/product.sample_weight)'=>array(
				'Fiber',
				'f'=>'quantity_html',
				'postfix'=>'g',
				'class'=>'number',
			),
			'SUM(consumption.weight*product.sodium/product.sample_weight)'=>array('Na',
				'f'=>'quantity_html',
				'postfix'=>'g',
				'class'=>'number',
			),
			'SUM(consumption.weight*product.calcium/product.sample_weight)'=>array('Ca',
				'f'=>'quantity_html',
				#'postfix'=>'mg',
				'class'=>'number',
			),
			'SUM(consumption.weight*product.phosphorus/product.sample_weight)'=>array('P',
				'f'=>'quantity_html',
				#'postfix'=>'mg',
				'class'=>'number',
			),
			'SUM(consumption.weight*product.magnesium/product.sample_weight)'=>array('Mg',
				'f'=>'quantity_html',
				#'postfix'=>'mg',
				'class'=>'number',
			),
			'SUM(consumption.weight*product.iron/product.sample_weight)'=>array('Fe',
				'f'=>'quantity_html',
				#'postfix'=>'mg',
				'class'=>'number',
			),
			'SUM(consumption.weight*product.a/product.sample_weight)'=>array('A',
				'f'=>'quantity_html',
				#'postfix'=>'mg',
				'class'=>'number',
			),
			'SUM(consumption.weight*product.b1/product.sample_weight)'=>array('B₁',
				'f'=>'quantity_html',
				#'postfix'=>'mg',
				'class'=>'number',
			),
			'SUM(consumption.weight*product.b2/product.sample_weight)'=>array('B₂',
				'f'=>'quantity_html',
				#'postfix'=>'mg',
				'class'=>'number',
			),
			'SUM(consumption.weight*product.b3/product.sample_weight)'=>array('B₃',
				'f'=>'quantity_html',
				#'postfix'=>'mg',
				'class'=>'number',
			),
			'SUM(consumption.weight*product.b6/product.sample_weight)'=>array('B₆',
				'f'=>'quantity_html',
				#'postfix'=>'mg',
				'class'=>'number',
			),
			'SUM(consumption.weight*product.b12/product.sample_weight)'=>array('B₁₂',
				'f'=>'quantity_html',
				#'postfix'=>'mg',
				'class'=>'number',
				'postfix'=>'μ',
			),
			'SUM(consumption.weight*product.c/product.sample_weight)'=>array('C',
				'f'=>'quantity_html',
				#'postfix'=>'mg',
				'class'=>'number',
			),
			'SUM(consumption.weight*product.d/product.sample_weight)'=>array('D',
				'f'=>'quantity_html',
				#'postfix'=>'mg',
				'class'=>'number',
				'postfix'=>'μ',
			),
			'SUM(consumption.weight*product.e/product.sample_weight)'=>array('E',
				'f'=>'quantity_html',
				#'postfix'=>'mg',
				'class'=>'number',
			),
		),
		'userorder'=>true,
		'showcount'=>false,
	));
	return include 'app/end.php';
?>
